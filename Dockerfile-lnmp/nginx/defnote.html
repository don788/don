<html><head></head>
<body>

<div><br></div><div><div><div>[root@k8s-registry nginx]# ll</div><div>total 968</div><div>-rw-r--r-- 1 root root &nbsp; &nbsp;397 Sep 24 &nbsp;2017 Dockerfile</div><div>-rw-r--r-- 1 root root 981093 Jul 11 &nbsp;2017 nginx-1.12.1.tar.gz</div><div>-rw-r--r-- 1 root root &nbsp; &nbsp;857 Sep 23 &nbsp;2017 nginx.conf</div><div>[root@k8s-registry nginx]# docker build -t 172.17.38.131:5000/lnmp-nginx:base .</div><div>Sending build context to Docker daemon &nbsp;985.6kB</div></div></div><div><br></div><div><br></div><div><div>[root@k8s-registry nginx]#<span class="Apple-style-span" style="background-color: rgb(255, 255, 0);"><b> cat Dockerfile&nbsp;</b></span></div><div>FROM centos:6</div><div>MAINTAINER lizhenliang</div><div>RUN yum install -y gcc gcc-c++ make openssl-devel pcre-devel &amp;&amp; \</div><div>&nbsp; &nbsp; yum clean all</div><div>ADD nginx-1.12.1.tar.gz /tmp</div><div>RUN cd /tmp/nginx-1.12.1 &amp;&amp; \</div><div>&nbsp; &nbsp; ./configure --prefix=/usr/local/nginx &amp;&amp; \</div><div>&nbsp; &nbsp; make -j 2 &amp;&amp; make install &amp;&amp; \</div><div>&nbsp; &nbsp; rm -rf /tmp/nginx-1.12.1</div><div>COPY nginx.conf /usr/local/nginx/conf</div><div><br></div><div>EXPOSE 80</div><div>CMD ["/usr/local/nginx/sbin/nginx", "-g", "daemon off;"]</div><div>[root@k8s-registry nginx]#&nbsp;</div></div><div><br></div><div><div>[root@k8s-registry nginx]# <span class="Apple-style-span" style="background-color: rgb(255, 255, 0);"><b>cat nginx.conf&nbsp;</b></span></div><div>user &nbsp;root;&nbsp;</div><div>worker_processes &nbsp;auto;&nbsp;</div><div><br></div><div>error_log &nbsp;logs/error.log &nbsp;info;</div><div><br></div><div>pid &nbsp; &nbsp; &nbsp; &nbsp;logs/nginx.pid;&nbsp;</div><div><br></div><div><br></div><div>events {</div><div>&nbsp; &nbsp; use epoll;&nbsp;</div><div>}</div><div><br></div><div>http {</div><div><br></div><div>&nbsp; &nbsp; include &nbsp; &nbsp; &nbsp; mime.types;</div><div>&nbsp; &nbsp; default_type &nbsp;application/octet-stream;</div><div><br></div><div>&nbsp; &nbsp; log_format &nbsp;main '$remote_addr - $remote_user [$time_local] "$request" '</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; '$status $body_bytes_sent "$http_referer" '</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; '"$http_user_agent" "$http_x_forwarded_for"';</div><div><br></div><div>&nbsp; &nbsp; access_log logs/access.log main;</div><div>&nbsp; &nbsp; sendfile &nbsp; &nbsp; &nbsp; &nbsp;on;</div><div>&nbsp; &nbsp; keepalive_timeout &nbsp;65;</div><div><br></div><div>&nbsp; &nbsp; server {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; listen 80;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; server_name localhost;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; root html;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; index index.php index.html;</div><div><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; location ~ \.php$ {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; root html;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; fastcgi_pass php-cgi:9000;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;&nbsp;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; include fastcgi_params;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; }</div><div>&nbsp; &nbsp; }</div><div>}</div><div>[root@k8s-registry nginx]#&nbsp;</div><div><br></div></div></body></html>