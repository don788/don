<html><head></head>
<body><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255); ">Compose是一个定义和管理多容器的工具，使用Python语言编写。使用Compose配置文件描述多个容器应用的架构，比如使用什么镜像、数据卷、网络、映射端口等；然后一条命令管理所有服务，比如启动、停止、重启等。</span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);"><br></span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">Linux系统安装Compose</span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);"><br></span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">通过compose构建相关容器编排非常简单，可以参考官方：</span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">https://docs.docker.com/compose/gettingstarted/#step-4-build-and-run-your-app-with-compose</span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);"><br></span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">compose安装：</span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">sudo curl -L https://github.com/docker/compose/releases/download/1.21.2/docker-compose-$(uname -s)-$(uname -m) -o /usr/local/bin/docker-compose</span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);"><br></span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">[root@test ~]# chmod +x /usr/local/bin/docker-compose&nbsp;</span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">[root@k8s-registry ~]# docker-compose version&nbsp;</span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">docker-compose version 1.21.2, build a133471</span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);"><br></span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);"><br></span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">[root@k8s-registry ~]# docker info</span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">Containers: 2</span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">&nbsp;Running: 1</span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">&nbsp;Paused: 0</span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">&nbsp;Stopped: 1</span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">Images: 20</span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">Server Version:</span><span class="Apple-style-span" style="background-color: rgb(255, 255, 0);"> 18.03.1-ce</span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);"><br></span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);"><br></span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">[root@k8s-registry ~]# cd compose-test/</span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">[root@k8s-registry compose-test]# ls</span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">docker-compose.yaml &nbsp;Dockerfile</span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">[root@k8s-registry compose-test]#&nbsp;</span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">[root@k8s-registry compose-test]# ll</span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">total 8</span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">-rw-r--r-- 1 root root &nbsp;72 Jun 23 13:43 </span><span class="Apple-style-span" style="background-color: rgb(255, 255, 0);">docker-compose.yaml</span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">-rw-r--r-- 1 root root 190 Jun 23 13:43 </span><span class="Apple-style-span" style="background-color: rgb(255, 255, 0);">Dockerfile</span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">[root@k8s-registry compose-test]# docker-compose up</span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">Creating network "compose-test_default" with the default driver</span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">Building web</span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">Step 1/6 : FROM centos:6</span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);"><br></span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">目录下内容：</span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">docker-compose.yml</span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 0);">version: '3'</span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">services:</span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">&nbsp;</span><span class="Apple-style-span" style="background-color: rgb(255, 255, 0);"><b> web:</b></span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">&nbsp; &nbsp; build: .</span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">&nbsp; &nbsp; ports:</span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">&nbsp; &nbsp; &nbsp; - "8888:80"</span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);"><br></span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);"><br></span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">Dockerfile</span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">FROM centos:6</span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">MAINTAINER lizhenliang</span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">RUN yum install -y httpd php php-gd php-mysql</span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">RUN echo "&lt;?php phpinfo()?&gt;" &gt; /var/www/html/index.php</span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">CMD ["/usr/sbin/httpd","-D","FOREGROUND"]</span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">EXPOSE 80</span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);"><br></span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">执行构建命令：</span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">up是启动和创建容器，启动构建 在前端运行</span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">[root@k8s-registry compose-test]# docker-compose up</span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);"><br></span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">[root@k8s-registry compose-test]# docker-compose up -d</span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">Starting compose-test_web_1 ... done</span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);"><br></span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">找到目录下的配置文件，才给列出来</span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">[root@k8s-registry compose-test]# docker-compose ps</span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">&nbsp; &nbsp; &nbsp; &nbsp;Name &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Command &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;State &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Ports &nbsp; &nbsp; &nbsp; &nbsp;</span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">---------------------------------------------------------------------------------</span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">compose-test_web_1 &nbsp; /usr/sbin/httpd -D FOREGROUND &nbsp; Up &nbsp; &nbsp; &nbsp;0.0.0.0:8888-&gt;80/tcp</span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);"><br></span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">[root@k8s-registry compose-test]# docker-compose restart web</span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">Restarting compose-test_web_1 ... done</span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);"><br></span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">访问测试</span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">http://59.110.214.109:8888/</span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);"><br></span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);"><br></span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">##################</span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">Usage: docker-compose [-f &lt;arg&gt;...] [options] [COMMAND] [ARGS...]</span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">选项：</span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">-f 指定Compose配置文件，默认docker-compose.yml</span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">-p 指定项目名称，默认目录名</span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">--verbose 显示更多的输出</span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);"><br></span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">YAML文件格式及编写注意事项</span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">YAML是一种标记语言很直观的数据序列化格式，可读性高。类似于XML数据描述语言，语法比XML简单的很多。</span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">YAML数据结构通过缩进来表示，连续的项目通过减号来表示，键值对用冒号分隔，数组用中括号括起来，hash用花括号括起来。</span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">YAML文件格式注意事项：</span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">1.不支持制表符tab键缩进，需要使用空格缩进</span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">2.</span><span class="Apple-style-span" style="background-color: rgb(255, 255, 0);">通常开头缩进2个空格</span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">3.</span><span class="Apple-style-span" style="background-color: rgb(255, 255, 0);">字符后缩进1个空格</span><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">，如冒号、逗号、横杆</span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">4.用井号注释</span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">5.如果包含特殊字符用单引号引起来</span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255); ">6.布尔值（true、false、yes、no、on、off）必须用引号括起来，这样分析器会将他们解释为字符串。</span></div>

</body></html>