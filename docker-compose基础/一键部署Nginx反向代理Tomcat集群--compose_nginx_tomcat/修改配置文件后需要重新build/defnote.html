<html><head></head>
<body><span class="Apple-style-span" style="background-color: rgb(255, 255, 255); ">修改nginx配置添加</span><div><div>&nbsp; &nbsp; log_format &nbsp;main '<span class="Apple-style-span" style="background-color: rgb(255, 255, 0); "><b>$upstream_addr</b></span>&nbsp;$remote_addr - $remote_user [$time_local] "$request" '</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; '$status $body_bytes_sent "$http_referer" '</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; '"$http_user_agent" "$http_x_forwarded_for"';</div><div><br></div><div><br></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 0);"><b>&nbsp;修改后</b></span><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 0);"><b>docker-compose up --build</b></span>

</div></div></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255); "><br></span></div><div><div style="background-color: rgb(255, 255, 255); ">[root@k8s-registry compose_nginx_tomcat]# docker-compose ps</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Name &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Command &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; State &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Ports &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</div><div style="background-color: rgb(255, 255, 255); ">-------------------------------------------------------------------------------------------------</div><div style="background-color: rgb(255, 255, 255); ">compose_nginx_tomcat_mysql_1 &nbsp; &nbsp; &nbsp;docker-entrypoint.sh mysqld &nbsp; &nbsp; &nbsp;Up &nbsp; &nbsp; &nbsp;0.0.0.0:3306-&gt;3306/tcp</div><div style="background-color: rgb(255, 255, 255); ">compose_nginx_tomcat_nginx_1 &nbsp; &nbsp; &nbsp;/usr/local/nginx/sbin/ngin ... &nbsp; Up &nbsp; &nbsp; &nbsp;0.0.0.0:80-&gt;80/tcp &nbsp; &nbsp;</div><div style="background-color: rgb(255, 255, 255); ">compose_nginx_tomcat_tomcat01_1 &nbsp; /usr/local/apache-tomcat-8 ... &nbsp; Up &nbsp; &nbsp; &nbsp;8080/tcp &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</div><div style="background-color: rgb(255, 255, 255); ">compose_nginx_tomcat_tomcat02_1 &nbsp; /usr/local/apache-tomcat-8 ... &nbsp; Up &nbsp; &nbsp; &nbsp;8080/tcp &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</div><div style="background-color: rgb(255, 255, 255); ">compose_nginx_tomcat_tomcat03_1 &nbsp; /usr/local/apache-tomcat-8 ... &nbsp; Up &nbsp; &nbsp; &nbsp;8080/tcp &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">[root@k8s-registry compose_nginx_tomcat]# </span><span class="Apple-style-span" style="background-color: rgb(255, 255, 0);"><b>docker exec -it compose_nginx_tomcat_nginx_1 &nbsp; bash</b></span></div><div style="background-color: rgb(255, 255, 255); ">[root@nginx /]# cd /usr/local/nginx/logs/</div><div style="background-color: rgb(255, 255, 255); ">[root@nginx logs]# tail -f access.log&nbsp;</div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 0);">172.21.0.3:8080</span><span class="Apple-style-span" style="background-color: rgb(255, 255, 255); "> 144.123.36.18 - - [23/Jun/2018:07:08:07 +0000] "GET / HTTP/1.1" 499 0 "-" "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.36 SE 2.X MetaSr 1.0" "-"</span></div><div style="background-color: rgb(255, 255, 255); "><br></div></div><div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 0);">172.21.0.5:8080</span><span class="Apple-style-span" style="background-color: rgb(255, 255, 255); "> 144.123.36.18 - - [23/Jun/2018:07:08:07 +0000] "GET / HTTP/1.1" 499 0 "-" "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.36 SE 2.X MetaSr 1.0" "-"</span></div><div style="background-color: rgb(255, 255, 255); "><br></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 0);">172.21.0.4:8080</span><span class="Apple-style-span" style="background-color: rgb(255, 255, 255); "> 144.123.36.18 - - [23/Jun/2018:07:08:07 +0000] "GET / HTTP/1.1" 200 12 "-" "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.36 SE 2.X MetaSr 1.0" "-"</span></div></div></body></html>