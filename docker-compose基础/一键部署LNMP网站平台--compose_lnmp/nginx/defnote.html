<html><head></head>
<body>

<div><br></div><div><div>[root@k8s-registry compose_lnmp]# cd nginx/</div><div>[root@k8s-registry nginx]# ls</div><div>Dockerfile &nbsp;nginx-1.12.1.tar.gz &nbsp;nginx.conf</div></div><div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255); ">[root@k8s-registry nginx]# </span><span class="Apple-style-span" style="background-color: rgb(255, 255, 0);"><b>cat Dockerfile</b></span><span class="Apple-style-span" style="background-color: rgb(255, 255, 255); ">&nbsp;</span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">FROM centos:6</span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">MAINTAINER lizhenliang</span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">RUN yum install -y gcc gcc-c++ make openssl-devel pcre-devel</span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">ADD nginx-1.12.1.tar.gz /tmp</span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">RUN cd /tmp/nginx-1.12.1 &amp;&amp; ./configure --prefix=/usr/local/nginx &amp;&amp; make -j 2 &amp;&amp; make install</span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">RUN rm -f /usr/local/nginx/conf/nginx.conf&nbsp;</span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">COPY nginx.conf /usr/local/nginx/conf</span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);"><br></span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">EXPOSE 80</span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">CMD ["/usr/local/nginx/sbin/nginx", "-g", "daemon off;"]</span></div></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);"><br></span></div><div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">[root@k8s-registry nginx]# </span><span class="Apple-style-span" style="background-color: rgb(255, 255, 0);"><b>cat nginx.conf&nbsp;</b></span></div><div style="background-color: rgb(255, 255, 255); ">user &nbsp;root;&nbsp;</div><div style="background-color: rgb(255, 255, 255); ">worker_processes &nbsp;auto;&nbsp;</div><div style="background-color: rgb(255, 255, 255); "><br></div><div style="background-color: rgb(255, 255, 255); ">error_log &nbsp;logs/error.log &nbsp;info;</div><div style="background-color: rgb(255, 255, 255); "><br></div><div style="background-color: rgb(255, 255, 255); ">pid &nbsp; &nbsp; &nbsp; &nbsp;logs/nginx.pid;&nbsp;</div><div style="background-color: rgb(255, 255, 255); "><br></div><div style="background-color: rgb(255, 255, 255); "><br></div><div style="background-color: rgb(255, 255, 255); ">events {</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; use epoll;&nbsp;</div><div style="background-color: rgb(255, 255, 255); ">}</div><div style="background-color: rgb(255, 255, 255); "><br></div><div style="background-color: rgb(255, 255, 255); ">http {</div><div style="background-color: rgb(255, 255, 255); "><br></div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; include &nbsp; &nbsp; &nbsp; mime.types;</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; default_type &nbsp;application/octet-stream;</div><div style="background-color: rgb(255, 255, 255); "><br></div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; log_format &nbsp;main '$remote_addr - $remote_user [$time_local] "$request" '</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; '$status $body_bytes_sent "$http_referer" '</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; '"$http_user_agent" "$http_x_forwarded_for"';</div><div style="background-color: rgb(255, 255, 255); "><br></div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; access_log logs/access.log main;</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; sendfile &nbsp; &nbsp; &nbsp; &nbsp;on;</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; keepalive_timeout &nbsp;65;</div><div style="background-color: rgb(255, 255, 255); "><br></div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; server {</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &nbsp; &nbsp; listen 80;</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &nbsp; &nbsp; server_name localhost;</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &nbsp; &nbsp; root html;</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &nbsp; &nbsp; index index.html index.php;</div><div style="background-color: rgb(255, 255, 255); "><br></div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &nbsp; &nbsp; location ~ \.php$ {</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; root html;</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; fastcgi_pass php-cgi:9000;</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;&nbsp;</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; include fastcgi_params;</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &nbsp; &nbsp; }</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; }</div><div style="background-color: rgb(255, 255, 255); ">}</div><div style="background-color: rgb(255, 255, 255); ">[root@k8s-registry nginx]#</div></div></body></html>