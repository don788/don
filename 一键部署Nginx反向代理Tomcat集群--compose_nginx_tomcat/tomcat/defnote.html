<html><head></head>
<body><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255); "><div>[root@k8s-registry compose_nginx_tomcat]# cd tomcat/</div><div>[root@k8s-registry tomcat]# ls</div><div>apache-tomcat-8.0.46.tar.gz &nbsp;Dockerfile &nbsp;server.xml</div><div><br></div></span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255); ">[root@k8s-registry tomcat]# cat </span><span class="Apple-style-span" style="background-color: rgb(255, 255, 0);">Dockerfile&nbsp;</span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">FROM centos:6</span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">MAINTAINER lizhenliang&nbsp;</span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">ADD jdk-8u45-linux-x64.tar.gz /usr/local</span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">ENV JAVA_HOME /usr/local/jdk1.8.0_45</span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">ADD apache-tomcat-8.0.46.tar.gz /usr/local</span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">COPY server.xml /usr/local/apache-tomcat-8.0.46/conf</span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);"><br></span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">EXPOSE 8080</span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">ENTRYPOINT ["/usr/local/apache-tomcat-8.0.46/bin/catalina.sh", "run"]</span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);"><br></span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);"><br></span></div><div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255); ">[root@k8s-registry tomcat]#</span><span class="Apple-style-span" style="background-color: rgb(255, 255, 0);"> cat server.xml&nbsp;</span></div><div style="background-color: rgb(255, 255, 255); ">&lt;?xml version='1.0' encoding='utf-8'?&gt;</div><div style="background-color: rgb(255, 255, 255); ">&lt;!--</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; Licensed to the Apache Software Foundation (ASF) under one or more</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; contributor license agreements. &nbsp;See the NOTICE file distributed with</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; this work for additional information regarding copyright ownership.</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; The ASF licenses this file to You under the Apache License, Version 2.0</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; (the "License"); you may not use this file except in compliance with</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; the License. &nbsp;You may obtain a copy of the License at</div><div style="background-color: rgb(255, 255, 255); "><br></div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &nbsp; http://www.apache.org/licenses/LICENSE-2.0</div><div style="background-color: rgb(255, 255, 255); "><br></div><div style="background-color: rgb(255, 255, 255); ">&nbsp; Unless required by applicable law or agreed to in writing, software</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; distributed under the License is distributed on an "AS IS" BASIS,</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; See the License for the specific language governing permissions and</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; limitations under the License.</div><div style="background-color: rgb(255, 255, 255); ">--&gt;</div><div style="background-color: rgb(255, 255, 255); ">&lt;!-- Note: &nbsp;A "Server" is not itself a "Container", so you may not</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &nbsp;define subcomponents such as "Valves" at this level.</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &nbsp;Documentation at /docs/config/server.html</div><div style="background-color: rgb(255, 255, 255); ">&nbsp;--&gt;</div><div style="background-color: rgb(255, 255, 255); ">&lt;Server port="8005" shutdown="SHUTDOWN"&gt;</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &lt;Listener className="org.apache.catalina.startup.VersionLoggerListener" /&gt;</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &lt;!-- Security listener. Documentation at /docs/config/listeners.html</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &lt;Listener className="org.apache.catalina.security.SecurityListener" /&gt;</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; --&gt;</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &lt;!--APR library loader. Documentation at /docs/apr.html --&gt;</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &lt;Listener className="org.apache.catalina.core.AprLifecycleListener" SSLEngine="on" /&gt;</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &lt;!-- Prevent memory leaks due to use of particular java/javax APIs--&gt;</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &lt;Listener className="org.apache.catalina.core.JreMemoryLeakPreventionListener" /&gt;</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &lt;Listener className="org.apache.catalina.mbeans.GlobalResourcesLifecycleListener" /&gt;</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &lt;Listener className="org.apache.catalina.core.ThreadLocalLeakPreventionListener" /&gt;</div><div style="background-color: rgb(255, 255, 255); "><br></div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &lt;!-- Global JNDI resources</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &nbsp; &nbsp;Documentation at /docs/jndi-resources-howto.html</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; --&gt;</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &lt;GlobalNamingResources&gt;</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &lt;!-- Editable user database that can also be used by</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;UserDatabaseRealm to authenticate users</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; --&gt;</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &lt;Resource name="UserDatabase" auth="Container"</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; type="org.apache.catalina.UserDatabase"</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; description="User database that can be updated and saved"</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; factory="org.apache.catalina.users.MemoryUserDatabaseFactory"</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pathname="conf/tomcat-users.xml" /&gt;</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &lt;/GlobalNamingResources&gt;</div><div style="background-color: rgb(255, 255, 255); "><br></div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &lt;!-- A "Service" is a collection of one or more "Connectors" that share</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &nbsp; &nbsp;a single "Container" Note: &nbsp;A "Service" is not itself a "Container",</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &nbsp; &nbsp;so you may not define subcomponents such as "Valves" at this level.</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &nbsp; &nbsp;Documentation at /docs/config/service.html</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp;--&gt;</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &lt;Service name="Catalina"&gt;</div><div style="background-color: rgb(255, 255, 255); "><br></div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &lt;!--The connectors can use a shared executor, you can define one or more named thread pools--&gt;</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &lt;!--</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &lt;Executor name="tomcatThreadPool" namePrefix="catalina-exec-"</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &nbsp; &nbsp; maxThreads="150" minSpareThreads="4"/&gt;</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; --&gt;</div><div style="background-color: rgb(255, 255, 255); "><br></div><div style="background-color: rgb(255, 255, 255); "><br></div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &lt;!-- A "Connector" represents an endpoint by which requests are received</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;and responses are returned. Documentation at :</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Java HTTP Connector: /docs/config/http.html (blocking &amp; non-blocking)</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Java AJP &nbsp;Connector: /docs/config/ajp.html</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;APR (HTTP/AJP) Connector: /docs/apr.html</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Define a non-SSL/TLS HTTP/1.1 Connector on port 8080</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; --&gt;</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &lt;Connector port="8080" protocol="HTTP/1.1"</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;connectionTimeout="20000"</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;redirectPort="8443" /&gt;</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &lt;!-- A "Connector" using the shared thread pool--&gt;</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &lt;!--</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &lt;Connector executor="tomcatThreadPool"</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;port="8080" protocol="HTTP/1.1"</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;connectionTimeout="20000"</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;redirectPort="8443" /&gt;</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; --&gt;</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &lt;!-- Define a SSL/TLS HTTP/1.1 Connector on port 8443</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This connector uses the NIO implementation that requires the JSSE</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;style configuration. When using the APR/native implementation, the</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;OpenSSL style configuration is required as described in the APR/native</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;documentation --&gt;</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &lt;!--</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &lt;Connector port="8443" protocol="org.apache.coyote.http11.Http11NioProtocol"</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;maxThreads="150" SSLEnabled="true" scheme="https" secure="true"</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;clientAuth="false" sslProtocol="TLS" /&gt;</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; --&gt;</div><div style="background-color: rgb(255, 255, 255); "><br></div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &lt;!-- Define an AJP 1.3 Connector on port 8009 --&gt;</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &lt;Connector port="8009" protocol="AJP/1.3" redirectPort="8443" /&gt;</div><div style="background-color: rgb(255, 255, 255); "><br></div><div style="background-color: rgb(255, 255, 255); "><br></div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &lt;!-- An Engine represents the entry point (within Catalina) that processes</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;every request. &nbsp;The Engine implementation for Tomcat stand alone</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;analyzes the HTTP headers included with the request, and passes them</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;on to the appropriate Host (virtual host).</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Documentation at /docs/config/engine.html --&gt;</div><div style="background-color: rgb(255, 255, 255); "><br></div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &lt;!-- You should set jvmRoute to support load-balancing via AJP ie :</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &lt;Engine name="Catalina" defaultHost="localhost" jvmRoute="jvm1"&gt;</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; --&gt;</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &lt;Engine name="Catalina" defaultHost="localhost"&gt;</div><div style="background-color: rgb(255, 255, 255); "><br></div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &nbsp; &lt;!--For clustering, please take a look at documentation at:</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /docs/cluster-howto.html &nbsp;(simple how to)</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /docs/config/cluster.html (reference documentation) --&gt;</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &nbsp; &lt;!--</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &nbsp; &lt;Cluster className="org.apache.catalina.ha.tcp.SimpleTcpCluster"/&gt;</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &nbsp; --&gt;</div><div style="background-color: rgb(255, 255, 255); "><br></div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &nbsp; &lt;!-- Use the LockOutRealm to prevent attempts to guess user passwords</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;via a brute-force attack --&gt;</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &nbsp; &lt;Realm className="org.apache.catalina.realm.LockOutRealm"&gt;</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &nbsp; &nbsp; &lt;!-- This Realm uses the UserDatabase configured in the global JNDI</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;resources under the key "UserDatabase". &nbsp;Any edits</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;that are performed against this UserDatabase are immediately</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;available for use by the Realm. &nbsp;--&gt;</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &nbsp; &nbsp; &lt;Realm className="org.apache.catalina.realm.UserDatabaseRealm"</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;resourceName="UserDatabase"/&gt;</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &nbsp; &lt;/Realm&gt;</div><div style="background-color: rgb(255, 255, 255); "><br></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 255);">&nbsp; &nbsp;</span><span class="Apple-style-span" style="background-color: rgb(255, 255, 0);"><b> &nbsp; &lt;Host name="localhost" &nbsp;appBase="webapps"</b></span></div><div><span class="Apple-style-span" style="background-color: rgb(255, 255, 0);"><b>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; unpackWARs="true" autoDeploy="true"&gt;</b></span></div><div style="background-color: rgb(255, 255, 255); "><br></div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &nbsp; &nbsp; &lt;!-- SingleSignOn valve, share authentication between web applications</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Documentation at: /docs/config/valve.html --&gt;</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &nbsp; &nbsp; &lt;!--</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &nbsp; &nbsp; &lt;Valve className="org.apache.catalina.authenticator.SingleSignOn" /&gt;</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &nbsp; &nbsp; --&gt;</div><div style="background-color: rgb(255, 255, 255); "><br></div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &nbsp; &nbsp; &lt;!-- Access log processes all example.</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Documentation at: /docs/config/valve.html</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Note: The pattern used is equivalent to using pattern="common" --&gt;</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &nbsp; &nbsp; &lt;Valve className="org.apache.catalina.valves.AccessLogValve" directory="logs"</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;prefix="localhost_access_log" suffix=".txt"</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;pattern="%h %l %u %t &amp;quot;%r&amp;quot; %s %b" /&gt;</div><div style="background-color: rgb(255, 255, 255); "><br></div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &nbsp; &lt;/Host&gt;</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &nbsp; &lt;/Engine&gt;</div><div style="background-color: rgb(255, 255, 255); ">&nbsp; &lt;/Service&gt;</div><div style="background-color: rgb(255, 255, 255); ">&lt;/Server&gt;</div></div>

</body></html>